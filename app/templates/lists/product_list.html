<div class="container mx-auto p-4" id="product-list">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200" x-data="{ 
            filters: { 
                code: '{{ code_filter_form.code.value|default:'' }}', 
                name: '{{ name_filter_form.name.value|default:'' }}', 
                categories: '', 
                suppliers: '' ,
                min_stock: '{{ stock_filter_form.min_stock.value|default:'' }}', 
                max_stock: '{{ stock_filter_form.max_stock.value|default:'' }}',
                min_daily_demand: '{{ daily_demand_filter_form.min_daily_demand.value|default:'' }}', 
                max_daily_demand: '{{ daily_demand_filter_form.max_daily_demand.value|default:'' }}',
                min_remainder_days: '{{ remainder_days_filter_form.min_remainder_days.value|default:'' }}', 
                max_remainder_days: '{{ remainder_days_filter_form.max_remainder_days.value|default:'' }}'
            }">
        <table class="w-full border-collapse">
            <thead class="bg-gray-50">
                <tr class="border-b border-gray-200">
                    <th
                        class="px-1 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        Code</th>
                    <th
                        class="px-1 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[80px] max-w-[120px] truncate">
                        Name</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        Category</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[80px] max-w-[100px] truncate">
                        Suppliers</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        Stock</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        Demand</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        Days</th>
                    <th
                        class="px-0.5 py-1 text-left text-xs font-medium text-black uppercase tracking-wider min-w-[60px] max-w-[80px] truncate">
                        PO Qty</th>
                </tr>
                <!-- Filter row -->
                {% include 'filters/product_filter.html' %}
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for product in products %}
                <tr class="hover:bg-gray-200 cursor-pointer border-b border-gray-200">
                    <td
                        class="px-1 py-0.5 whitespace-nowrap text-xs font-medium text-gray-700 border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        {{ product.code }}
                    </td>
                    <td
                        class="px-1 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 min-w-[80px] max-w-[120px] truncate">
                        {{ product.name }}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 min-w-[60px] max-w-[80px] truncate">
                        {% if product.category %}
                        {{ product.category }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 min-w-[80px] max-w-[100px] truncate">
                        {% for supplier in product.suppliers.all %}
                        {{ supplier.company_name }}{% if not forloop.last %}, {% endif %}
                        {% empty %}
                        -
                        {% endfor %}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 text-left min-w-[60px] max-w-[80px] truncate">
                        {% if product.current_stock is not None %}
                        {{ product.current_stock }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 text-left min-w-[60px] max-w-[80px] truncate">
                        {% if product.avg_daily_demand is not None %}
                        {{ product.avg_daily_demand|floatformat:2 }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 border-r border-gray-200 text-left min-w-[60px] max-w-[80px] truncate">
                        {% if product.remainder_days is not None %}
                        {{ product.remainder_days }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td
                        class="px-0.5 py-0.5 whitespace-nowrap text-xs text-gray-700 text-left min-w-[60px] max-w-[80px] truncate">
                        {% if product.po_quantity is not None %}
                        {{ product.po_quantity|floatformat:2 }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" class="px-6 py-4 text-center text-gray-500">
                        No products found
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    {% include 'partials/pagination.html' with page_obj=products %}
    {% include 'partials/orderDays.html' %}
</div>